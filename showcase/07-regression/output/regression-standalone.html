<!DOCTYPE html><html><head><meta charset="UTF-8">
<style>
body{font-family:"SF Mono","Fira Code",monospace;max-width:960px;margin:0 auto;padding:20px;background:#0d1117;color:#c9d1d9}
.code-block{background:#161b22;padding:12px;margin:6px 0;border-radius:6px;overflow-x:auto;font-size:14px}
.prose-block{padding:8px 0} .prose-block h1{color:#58a6ff;border-bottom:1px solid #30363d;padding-bottom:8px}
.prose-block h2{color:#58a6ff}
.result{background:#1c2128;padding:10px;margin:2px 0;border-left:3px solid #3fb950;border-radius:0 4px 4px 0;font-size:13px}
.error{background:#1c0000;padding:10px;margin:2px 0;border-left:3px solid #f85149;border-radius:0 4px 4px 0}
img.plot-img{max-width:100%;height:auto;display:block;margin:12px auto;border-radius:4px;border:1px solid #30363d}
svg{max-width:100%;height:auto;display:block;margin:12px auto}
pre{margin:0;white-space:pre-wrap}
span{white-space:pre-wrap}
</style></head><body>
<h1 style="color:#58a6ff;text-align:center">07-regression</h1><hr style="border-color:#30363d">
<div class="code-block"><span class="comment"></span></div>
<div class="prose-block"><h1>Basis Function Regression</h1>
</div>
<div class="code-block"><span class="keyword" id="span_2_1">import</span><span> </span><span id="span_2_2">plot</span><span class="comment">
</span></div>
<div class="code-block"><span class="comment">

</span></div>
<div class="code-block"><span class="keyword" id="span_4_4">struct</span><span> </span><span id="span_4_5">SolverState</span><span class="symbol" id="span_4_7">(</span><span id="span_4_8">n</span><span class="symbol" id="span_4_9">|</span><span id="span_4_11">Ix</span><span class="symbol" id="span_4_12">)</span><span> </span><span class="symbol" id="span_4_13">=</span><span class="comment">
  </span><span id="span_4_14">x</span><span> </span><span class="symbol" id="span_4_15">:</span><span> </span><span id="span_4_16">n</span><span class="symbol" id="span_4_17">=&gt;</span><span id="span_4_19">Float</span><span class="comment">
  </span><span id="span_4_20">r</span><span> </span><span class="symbol" id="span_4_21">:</span><span> </span><span id="span_4_22">n</span><span class="symbol" id="span_4_23">=&gt;</span><span id="span_4_25">Float</span><span class="comment">
  </span><span id="span_4_26">p</span><span> </span><span class="symbol" id="span_4_27">:</span><span> </span><span id="span_4_28">n</span><span class="symbol" id="span_4_29">=&gt;</span><span id="span_4_31">Float</span><span class="comment">
</span></div>
<div class="code-block"><span class="comment">
</span></div>
<div class="code-block"><span class="comment"># Conjugate gradients solver
</span></div>
<div class="code-block"><span class="keyword" id="span_7_33">def</span><span> </span><span id="span_7_34">solve</span><span class="symbol" id="span_7_36">(</span><span id="span_7_37">mat</span><span class="symbol" id="span_7_38">:</span><span id="span_7_40">m</span><span class="symbol" id="span_7_41">=&gt;</span><span id="span_7_43">m</span><span class="symbol" id="span_7_44">=&gt;</span><span id="span_7_46">Float</span><span class="symbol" id="span_7_47">,</span><span> </span><span id="span_7_48">b</span><span class="symbol" id="span_7_49">:</span><span id="span_7_51">m</span><span class="symbol" id="span_7_52">=&gt;</span><span id="span_7_54">Float</span><span class="symbol" id="span_7_55">)</span><span> </span><span class="symbol" id="span_7_56">-&gt;</span><span> </span><span id="span_7_57">m</span><span class="symbol" id="span_7_58">=&gt;</span><span id="span_7_60">Float</span><span> </span><span class="keyword" id="span_7_61">given</span><span> </span><span class="symbol" id="span_7_63">(</span><span id="span_7_64">m</span><span class="symbol" id="span_7_65">|</span><span id="span_7_67">Ix</span><span class="symbol" id="span_7_68">)</span><span> </span><span class="symbol" id="span_7_69">=</span><span class="comment">
  </span><span id="span_7_72">x0</span><span> </span><span class="symbol" id="span_7_73">=</span><span> </span><span id="span_7_74">zero</span><span> </span><span class="symbol" id="span_7_75">::</span><span> </span><span id="span_7_77">m</span><span class="symbol" id="span_7_78">=&gt;</span><span id="span_7_80">Float</span><span class="comment">
  </span><span id="span_7_82">r0</span><span> </span><span class="symbol" id="span_7_83">=</span><span> </span><span id="span_7_84">b</span><span> </span><span class="symbol" id="span_7_85">-</span><span> </span><span class="symbol" id="span_7_88">(</span><span id="span_7_89">mat</span><span> </span><span class="symbol" id="span_7_90">**.</span><span> </span><span id="span_7_92">x0</span><span class="symbol" id="span_7_93">)</span><span class="comment">
  </span><span id="span_7_95">n_iter</span><span> </span><span class="symbol" id="span_7_96">=</span><span> </span><span id="span_7_97">size</span><span> </span><span id="span_7_99">m</span><span class="comment">
  </span><span id="span_7_101">result</span><span> </span><span class="symbol" id="span_7_102">=</span><span> </span><span id="span_7_103">apply_n</span><span class="symbol" id="span_7_106">(</span><span id="span_7_107">n_iter</span><span class="symbol" id="span_7_108">,</span><span> </span><span id="span_7_109">SolverState</span><span class="symbol" id="span_7_112">(</span><span id="span_7_113">x0</span><span class="symbol" id="span_7_114">,</span><span> </span><span id="span_7_115">r0</span><span class="symbol" id="span_7_116">,</span><span> </span><span id="span_7_117">r0</span><span class="symbol" id="span_7_118">)</span><span class="symbol" id="span_7_119">)</span><span> </span><span class="symbol" id="span_7_122">\</span><span id="span_7_123">s</span><span class="symbol" id="span_7_124">.</span><span class="comment">
    </span><span id="span_7_127">r</span><span> </span><span class="symbol" id="span_7_128">=</span><span> </span><span id="span_7_129">s</span><span class="symbol" id="span_7_131">.</span><span id="span_7_132">r</span><span class="comment">
    </span><span id="span_7_134">p</span><span> </span><span class="symbol" id="span_7_135">=</span><span> </span><span id="span_7_136">s</span><span class="symbol" id="span_7_138">.</span><span id="span_7_139">p</span><span class="comment">
    </span><span id="span_7_141">ap</span><span> </span><span class="symbol" id="span_7_142">=</span><span> </span><span id="span_7_143">mat</span><span> </span><span class="symbol" id="span_7_144">**.</span><span> </span><span id="span_7_146">p</span><span class="comment">
    </span><span id="span_7_148">alpha</span><span> </span><span class="symbol" id="span_7_149">=</span><span> </span><span id="span_7_150">vdot</span><span> </span><span id="span_7_152">r</span><span> </span><span id="span_7_154">r</span><span> </span><span class="symbol" id="span_7_155">/</span><span> </span><span id="span_7_157">vdot</span><span> </span><span id="span_7_159">p</span><span> </span><span id="span_7_161">ap</span><span class="comment">
    </span><span id="span_7_163">x&#39;</span><span> </span><span class="symbol" id="span_7_164">=</span><span> </span><span id="span_7_165">s</span><span class="symbol" id="span_7_167">.</span><span id="span_7_168">x</span><span> </span><span class="symbol" id="span_7_169">+</span><span> </span><span id="span_7_171">alpha</span><span> </span><span class="symbol" id="span_7_172">.*</span><span> </span><span id="span_7_174">p</span><span class="comment">
    </span><span id="span_7_176">r&#39;</span><span> </span><span class="symbol" id="span_7_177">=</span><span> </span><span id="span_7_178">r</span><span> </span><span class="symbol" id="span_7_179">-</span><span> </span><span id="span_7_181">alpha</span><span> </span><span class="symbol" id="span_7_182">.*</span><span> </span><span id="span_7_184">ap</span><span class="comment">
    </span><span id="span_7_186">beta</span><span> </span><span class="symbol" id="span_7_187">=</span><span> </span><span id="span_7_188">vdot</span><span> </span><span id="span_7_190">r&#39;</span><span> </span><span id="span_7_192">r&#39;</span><span> </span><span class="symbol" id="span_7_193">/</span><span> </span><span class="symbol" id="span_7_196">(</span><span id="span_7_197">vdot</span><span> </span><span id="span_7_199">r</span><span> </span><span id="span_7_201">r</span><span> </span><span class="symbol" id="span_7_202">+</span><span> </span><span class="literal" id="span_7_204">0.000001</span><span class="symbol" id="span_7_205">)</span><span class="comment">
    </span><span id="span_7_207">p&#39;</span><span> </span><span class="symbol" id="span_7_208">=</span><span> </span><span id="span_7_209">r&#39;</span><span> </span><span class="symbol" id="span_7_210">+</span><span> </span><span id="span_7_212">beta</span><span> </span><span class="symbol" id="span_7_213">.*</span><span> </span><span id="span_7_215">p</span><span class="comment">
    </span><span id="span_7_217">SolverState</span><span class="symbol" id="span_7_220">(</span><span id="span_7_221">x&#39;</span><span class="symbol" id="span_7_222">,</span><span> </span><span id="span_7_223">r&#39;</span><span class="symbol" id="span_7_224">,</span><span> </span><span id="span_7_225">p&#39;</span><span class="symbol" id="span_7_226">)</span><span class="comment">
  </span><span id="span_7_228">result</span><span class="symbol" id="span_7_230">.</span><span id="span_7_231">x</span><span class="comment">
</span></div>
<div class="code-block"><span class="comment">
</span></div>
<div class="prose-block"><p>Make some synthetic data</p>
</div>
<div class="code-block"><span id="span_10_233">Nx</span><span> </span><span class="symbol" id="span_10_234">=</span><span> </span><span id="span_10_235">Fin</span><span> </span><span class="literal" id="span_10_237">100</span><span class="comment">
</span></div>
<div class="code-block"><span id="span_11_239">noise</span><span> </span><span class="symbol" id="span_11_240">=</span><span> </span><span class="literal" id="span_11_241">0.1</span><span class="comment">
</span></div>
<div class="code-block"><span class="symbol" id="span_12_244">[</span><span id="span_12_245">k1</span><span class="symbol" id="span_12_246">,</span><span> </span><span id="span_12_247">k2</span><span class="symbol" id="span_12_248">]</span><span> </span><span class="symbol" id="span_12_249">=</span><span> </span><span id="span_12_250">split_key</span><span> </span><span class="symbol" id="span_12_253">(</span><span id="span_12_254">new_key</span><span> </span><span class="literal" id="span_12_256">0</span><span class="symbol" id="span_12_257">)</span><span class="comment">
</span></div>
<div class="code-block"><span class="comment">
</span></div>
<div class="code-block"><span class="keyword" id="span_14_259">def</span><span> </span><span id="span_14_260">trueFun</span><span class="symbol" id="span_14_262">(</span><span id="span_14_263">x</span><span class="symbol" id="span_14_264">:</span><span id="span_14_266">Float</span><span class="symbol" id="span_14_267">)</span><span> </span><span class="symbol" id="span_14_268">-&gt;</span><span> </span><span id="span_14_269">Float</span><span> </span><span class="symbol" id="span_14_270">=</span><span class="comment">
  </span><span id="span_14_273">x</span><span> </span><span class="symbol" id="span_14_274">+</span><span> </span><span id="span_14_276">sin</span><span> </span><span class="symbol" id="span_14_279">(</span><span class="literal" id="span_14_280">5.0</span><span> </span><span class="symbol" id="span_14_281">*</span><span> </span><span id="span_14_283">x</span><span class="symbol" id="span_14_284">)</span><span class="comment">
</span></div>
<div class="code-block"><span class="comment">
</span></div>
<div class="code-block"><span id="span_16_286">xs</span><span> </span><span class="symbol" id="span_16_287">:</span><span> </span><span id="span_16_289">Nx</span><span class="symbol" id="span_16_290">=&gt;</span><span id="span_16_292">Float</span><span> </span><span class="symbol" id="span_16_293">=</span><span> </span><span class="keyword" id="span_16_295">for</span><span> </span><span id="span_16_296">i</span><span class="symbol" id="span_16_297">.</span><span> </span><span id="span_16_298">rand</span><span> </span><span class="symbol" id="span_16_301">(</span><span id="span_16_302">ixkey</span><span> </span><span id="span_16_304">k1</span><span> </span><span id="span_16_306">i</span><span class="symbol" id="span_16_307">)</span><span class="comment">
</span></div>
<div class="code-block"><span id="span_17_309">ys</span><span> </span><span class="symbol" id="span_17_310">:</span><span> </span><span id="span_17_312">Nx</span><span class="symbol" id="span_17_313">=&gt;</span><span id="span_17_315">Float</span><span> </span><span class="symbol" id="span_17_316">=</span><span> </span><span class="keyword" id="span_17_318">for</span><span> </span><span id="span_17_319">i</span><span class="symbol" id="span_17_320">.</span><span> </span><span id="span_17_321">trueFun</span><span> </span><span id="span_17_323">xs</span><span class="symbol" id="span_17_326">[</span><span id="span_17_327">i</span><span class="symbol" id="span_17_328">]</span><span> </span><span class="symbol" id="span_17_329">+</span><span> </span><span id="span_17_331">noise</span><span> </span><span class="symbol" id="span_17_332">*</span><span> </span><span id="span_17_334">randn</span><span> </span><span class="symbol" id="span_17_337">(</span><span id="span_17_338">ixkey</span><span> </span><span id="span_17_340">k2</span><span> </span><span id="span_17_342">i</span><span class="symbol" id="span_17_343">)</span><span class="comment">
</span></div>
<div class="code-block"><span class="comment">
</span></div>
<div class="code-block"><span class="comment">:</span><span id="span_19_344">html</span><span> </span><span id="span_19_345">show_plot</span><span> </span><span class="symbol" id="span_19_346">$</span><span> </span><span id="span_19_348">xy_plot</span><span> </span><span id="span_19_350">xs</span><span> </span><span id="span_19_352">ys</span><span class="comment">
</span></div>
<div class="code-block"><span class="comment">
</span></div>
<div class="prose-block"><p>Implement basis function regression</p>
</div>
<div class="code-block"><span class="keyword" id="span_22_354">def</span><span> </span><span id="span_22_355">regress</span><span class="symbol" id="span_22_357">(</span><span id="span_22_358">featurize</span><span class="symbol" id="span_22_359">:</span><span> </span><span class="symbol" id="span_22_362">(</span><span id="span_22_363">Float</span><span class="symbol" id="span_22_364">)</span><span> </span><span class="symbol" id="span_22_365">-&gt;</span><span> </span><span id="span_22_367">d</span><span class="symbol" id="span_22_368">=&gt;</span><span id="span_22_370">Float</span><span class="symbol" id="span_22_371">,</span><span> </span><span id="span_22_372">xRaw</span><span class="symbol" id="span_22_373">:</span><span id="span_22_375">n</span><span class="symbol" id="span_22_376">=&gt;</span><span id="span_22_378">Float</span><span class="symbol" id="span_22_379">,</span><span> </span><span id="span_22_380">y</span><span class="symbol" id="span_22_381">:</span><span id="span_22_383">n</span><span class="symbol" id="span_22_384">=&gt;</span><span id="span_22_386">Float</span><span class="symbol" id="span_22_387">)</span><span> </span><span class="symbol" id="span_22_388">-&gt;</span><span> </span><span id="span_22_389">d</span><span class="symbol" id="span_22_390">=&gt;</span><span id="span_22_392">Float</span><span> </span><span class="keyword" id="span_22_393">given</span><span> </span><span class="symbol" id="span_22_395">(</span><span id="span_22_396">d</span><span class="symbol" id="span_22_397">|</span><span id="span_22_399">Ix</span><span class="symbol" id="span_22_400">,</span><span> </span><span id="span_22_401">n</span><span class="symbol" id="span_22_402">|</span><span id="span_22_404">Ix</span><span class="symbol" id="span_22_405">)</span><span> </span><span class="symbol" id="span_22_406">=</span><span class="comment">
  </span><span id="span_22_409">x</span><span> </span><span class="symbol" id="span_22_410">=</span><span> </span><span id="span_22_411">map</span><span> </span><span id="span_22_413">featurize</span><span> </span><span id="span_22_415">xRaw</span><span class="comment">
  </span><span id="span_22_417">xT</span><span> </span><span class="symbol" id="span_22_418">=</span><span> </span><span id="span_22_419">transpose</span><span> </span><span id="span_22_421">x</span><span class="comment">
  </span><span id="span_22_423">solve</span><span> </span><span class="symbol" id="span_22_426">(</span><span id="span_22_427">xT</span><span> </span><span class="symbol" id="span_22_428">**</span><span> </span><span id="span_22_430">x</span><span class="symbol" id="span_22_431">)</span><span> </span><span class="symbol" id="span_22_434">(</span><span id="span_22_435">xT</span><span> </span><span class="symbol" id="span_22_436">**.</span><span> </span><span id="span_22_438">y</span><span class="symbol" id="span_22_439">)</span><span class="comment">
</span></div>
<div class="code-block"><span class="comment">
</span></div>
<div class="prose-block"><p>Fit a third-order polynomial</p>
</div>
<div class="code-block"><span class="keyword" id="span_25_441">def</span><span> </span><span id="span_25_442">poly</span><span class="symbol" id="span_25_444">(</span><span id="span_25_445">x</span><span class="symbol" id="span_25_446">:</span><span id="span_25_448">Float</span><span class="symbol" id="span_25_449">)</span><span> </span><span class="symbol" id="span_25_450">-&gt;</span><span> </span><span id="span_25_451">d</span><span class="symbol" id="span_25_452">=&gt;</span><span id="span_25_454">Float</span><span> </span><span class="keyword" id="span_25_455">given</span><span> </span><span class="symbol" id="span_25_457">(</span><span id="span_25_458">d</span><span class="symbol" id="span_25_459">|</span><span id="span_25_461">Ix</span><span class="symbol" id="span_25_462">)</span><span> </span><span class="symbol" id="span_25_463">=</span><span class="comment">
  </span><span class="keyword" id="span_25_467">for</span><span> </span><span id="span_25_468">i</span><span class="symbol" id="span_25_469">.</span><span> </span><span id="span_25_470">pow</span><span> </span><span id="span_25_472">x</span><span> </span><span class="symbol" id="span_25_475">(</span><span id="span_25_476">n_to_f</span><span> </span><span class="symbol" id="span_25_479">(</span><span id="span_25_480">ordinal</span><span> </span><span id="span_25_482">i</span><span class="symbol" id="span_25_483">)</span><span class="symbol" id="span_25_484">)</span><span class="comment">
</span></div>
<div class="code-block"><span class="comment">
</span></div>
<div class="code-block"><span id="span_27_486">params</span><span> </span><span class="symbol" id="span_27_487">:</span><span> </span><span class="symbol" id="span_27_490">(</span><span id="span_27_491">Fin</span><span> </span><span class="literal" id="span_27_493">4</span><span class="symbol" id="span_27_494">)</span><span class="symbol" id="span_27_495">=&gt;</span><span id="span_27_497">Float</span><span> </span><span class="symbol" id="span_27_498">=</span><span> </span><span id="span_27_499">regress</span><span> </span><span id="span_27_501">poly</span><span> </span><span id="span_27_503">xs</span><span> </span><span id="span_27_505">ys</span><span class="comment">
</span></div>
<div class="code-block"><span class="comment">
</span></div>
<div class="code-block"><span class="keyword" id="span_29_507">def</span><span> </span><span id="span_29_508">predict</span><span class="symbol" id="span_29_510">(</span><span id="span_29_511">x</span><span class="symbol" id="span_29_512">:</span><span id="span_29_514">Float</span><span class="symbol" id="span_29_515">)</span><span> </span><span class="symbol" id="span_29_516">-&gt;</span><span> </span><span id="span_29_517">Float</span><span> </span><span class="symbol" id="span_29_518">=</span><span class="comment">
  </span><span id="span_29_521">vdot</span><span> </span><span id="span_29_523">params</span><span> </span><span class="symbol" id="span_29_526">(</span><span id="span_29_527">poly</span><span> </span><span id="span_29_529">x</span><span class="symbol" id="span_29_530">)</span><span class="comment">
</span></div>
<div class="code-block"><span class="comment">

</span></div>
<div class="code-block"><span id="span_31_532">xsTest</span><span> </span><span class="symbol" id="span_31_533">=</span><span> </span><span id="span_31_534">linspace</span><span> </span><span class="symbol" id="span_31_537">(</span><span id="span_31_538">Fin</span><span> </span><span class="literal" id="span_31_540">200</span><span class="symbol" id="span_31_541">)</span><span> </span><span class="literal" id="span_31_543">0.0</span><span> </span><span class="literal" id="span_31_545">1.0</span><span class="comment">
</span></div>
<div class="code-block"><span class="comment">
</span></div>
<div class="code-block"><span class="comment">:</span><span id="span_33_546">html</span><span> </span><span id="span_33_547">show_plot</span><span> </span><span class="symbol" id="span_33_548">$</span><span> </span><span id="span_33_550">xy_plot</span><span> </span><span id="span_33_552">xsTest</span><span> </span><span class="symbol" id="span_33_555">(</span><span id="span_33_556">map</span><span> </span><span id="span_33_558">predict</span><span> </span><span id="span_33_560">xsTest</span><span class="symbol" id="span_33_561">)</span><span class="comment">
</span></div>
<div class="code-block"><span class="comment">
</span></div>
<div class="prose-block"><p>RMS error</p>
</div>
<div class="code-block"><span class="keyword" id="span_36_563">def</span><span> </span><span id="span_36_564">rmsErr</span><span class="symbol" id="span_36_566">(</span><span id="span_36_567">truth</span><span class="symbol" id="span_36_568">:</span><span id="span_36_570">n</span><span class="symbol" id="span_36_571">=&gt;</span><span id="span_36_573">Float</span><span class="symbol" id="span_36_574">,</span><span> </span><span id="span_36_575">pred</span><span class="symbol" id="span_36_576">:</span><span id="span_36_578">n</span><span class="symbol" id="span_36_579">=&gt;</span><span id="span_36_581">Float</span><span class="symbol" id="span_36_582">)</span><span> </span><span class="symbol" id="span_36_583">-&gt;</span><span> </span><span id="span_36_584">Float</span><span> </span><span class="keyword" id="span_36_585">given</span><span> </span><span class="symbol" id="span_36_587">(</span><span id="span_36_588">n</span><span class="symbol" id="span_36_589">|</span><span id="span_36_591">Ix</span><span class="symbol" id="span_36_592">)</span><span> </span><span class="symbol" id="span_36_593">=</span><span class="comment">
  </span><span id="span_36_596">sqrt</span><span> </span><span class="symbol" id="span_36_597">$</span><span> </span><span id="span_36_599">mean</span><span> </span><span class="keyword" id="span_36_602">for</span><span> </span><span id="span_36_603">i</span><span class="symbol" id="span_36_604">.</span><span> </span><span id="span_36_605">sq</span><span> </span><span class="symbol" id="span_36_608">(</span><span id="span_36_609">pred</span><span class="symbol" id="span_36_612">[</span><span id="span_36_613">i</span><span class="symbol" id="span_36_614">]</span><span> </span><span class="symbol" id="span_36_615">-</span><span> </span><span id="span_36_617">truth</span><span class="symbol" id="span_36_620">[</span><span id="span_36_621">i</span><span class="symbol" id="span_36_622">]</span><span class="symbol" id="span_36_623">)</span><span class="comment">
</span></div>
<div class="code-block"><span class="comment">
</span></div>
<div class="code-block"><span class="comment">:</span><span id="span_38_624">p</span><span> </span><span id="span_38_625">rmsErr</span><span> </span><span id="span_38_627">ys</span><span> </span><span class="symbol" id="span_38_630">(</span><span id="span_38_631">map</span><span> </span><span id="span_38_633">predict</span><span> </span><span id="span_38_635">xs</span><span class="symbol" id="span_38_636">)</span><span class="comment">
</span></div>
<div class="code-block"><span class="comment">
</span></div>
<div class="code-block"><span class="keyword" id="span_40_638">def</span><span> </span><span id="span_40_639">tabCat</span><span class="symbol" id="span_40_641">(</span><span id="span_40_642">xs</span><span class="symbol" id="span_40_643">:</span><span id="span_40_645">n</span><span class="symbol" id="span_40_646">=&gt;</span><span id="span_40_648">a</span><span class="symbol" id="span_40_649">,</span><span> </span><span id="span_40_650">ys</span><span class="symbol" id="span_40_651">:</span><span id="span_40_653">m</span><span class="symbol" id="span_40_654">=&gt;</span><span id="span_40_656">a</span><span class="symbol" id="span_40_657">)</span><span> </span><span class="symbol" id="span_40_658">-&gt;</span><span> </span><span class="symbol" id="span_40_660">(</span><span id="span_40_661">Either</span><span> </span><span id="span_40_663">n</span><span> </span><span id="span_40_665">m</span><span class="symbol" id="span_40_666">)</span><span class="symbol" id="span_40_667">=&gt;</span><span id="span_40_669">a</span><span> </span><span class="keyword" id="span_40_670">given</span><span> </span><span class="symbol" id="span_40_672">(</span><span id="span_40_673">n</span><span class="symbol" id="span_40_674">|</span><span id="span_40_676">Ix</span><span class="symbol" id="span_40_677">,</span><span> </span><span id="span_40_678">m</span><span class="symbol" id="span_40_679">|</span><span id="span_40_681">Ix</span><span class="symbol" id="span_40_682">,</span><span> </span><span id="span_40_683">a</span><span class="symbol" id="span_40_684">)</span><span> </span><span class="symbol" id="span_40_685">=</span><span class="comment">
  </span><span class="keyword" id="span_40_689">for</span><span> </span><span id="span_40_690">i</span><span class="symbol" id="span_40_691">.</span><span> </span><span class="keyword" id="span_40_693">case</span><span> </span><span id="span_40_694">i</span><span> </span><span class="keyword" id="span_40_695">of</span><span class="comment">
    </span><span id="span_40_696">Left</span><span>  </span><span id="span_40_698">i&#39;</span><span> </span><span class="symbol" id="span_40_699">-&gt;</span><span> </span><span id="span_40_700">xs</span><span class="symbol" id="span_40_703">[</span><span id="span_40_704">i&#39;</span><span class="symbol" id="span_40_705">]</span><span class="comment">
    </span><span id="span_40_706">Right</span><span> </span><span id="span_40_708">i&#39;</span><span> </span><span class="symbol" id="span_40_709">-&gt;</span><span> </span><span id="span_40_710">ys</span><span class="symbol" id="span_40_713">[</span><span id="span_40_714">i&#39;</span><span class="symbol" id="span_40_715">]</span><span class="comment">
</span></div>
<div class="code-block"><span class="comment">
</span></div>
<div class="code-block"><span id="span_42_717">xsPlot</span><span> </span><span class="symbol" id="span_42_718">=</span><span> </span><span id="span_42_719">tabCat</span><span> </span><span id="span_42_721">xs</span><span> </span><span id="span_42_723">xsTest</span><span class="comment">
</span></div>
<div class="code-block"><span id="span_43_725">ysPlot</span><span> </span><span class="symbol" id="span_43_726">=</span><span> </span><span id="span_43_727">tabCat</span><span> </span><span id="span_43_729">ys</span><span> </span><span class="symbol" id="span_43_730">$</span><span> </span><span id="span_43_732">map</span><span> </span><span id="span_43_734">predict</span><span> </span><span id="span_43_736">xsTest</span><span class="comment">
</span></div>
<div class="code-block"><span class="comment">
</span></div>
<div class="code-block"><span class="comment">:</span><span id="span_45_737">html</span><span> </span><span id="span_45_738">show_plot</span><span> </span><span class="symbol" id="span_45_739">$</span><span> </span><span id="span_45_741">xyc_plot</span><span> </span><span id="span_45_743">xsPlot</span><span> </span><span id="span_45_745">ysPlot</span><span> </span><span class="symbol" id="span_45_746">$</span><span class="comment">
        </span><span class="keyword" id="span_45_749">for</span><span> </span><span id="span_45_750">i</span><span class="symbol" id="span_45_751">.</span><span> </span><span class="keyword" id="span_45_753">case</span><span> </span><span id="span_45_754">i</span><span> </span><span class="keyword" id="span_45_755">of</span><span class="comment">
                 </span><span id="span_45_756">Left</span><span>  </span><span class="symbol" id="span_45_759">_</span><span> </span><span class="symbol" id="span_45_760">-&gt;</span><span> </span><span class="literal" id="span_45_761">0.0</span><span class="comment">
                 </span><span id="span_45_762">Right</span><span> </span><span class="symbol" id="span_45_765">_</span><span> </span><span class="symbol" id="span_45_766">-&gt;</span><span> </span><span class="literal" id="span_45_767">1.0</span><span class="comment">
</span></div>
</body></html>